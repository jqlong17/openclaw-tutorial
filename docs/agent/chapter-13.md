# 第 13 章：工具系统

> 本章将讲解 OpenClaw 的工具系统，包括工具的概念、类型和使用方式。

---

## 13.1 什么是工具？

### 13.1.1 工具的作用

**AI 模型的局限**：

AI 模型虽然聪明，但它：
- ❌ 不能访问互联网
- ❌ 不能读取你的本地文件
- ❌ 不能执行代码
- ❌ 不能操作浏览器

**工具的桥梁作用**：

工具让 AI 能够**做实事**，把 AI 的"想法"变成"行动"。

**类比理解**：

想象 AI 是一个**大脑**：
- 它能思考、规划、决策
- 但它没有手，不能实际操作

工具就是**手**：
- 读取文件 = 用手翻开书本
- 执行代码 = 用手操作电脑
- 发送邮件 = 用手写好信封寄出

### 13.1.2 实际例子

**场景：查询天气**

没有工具时：
> 你：北京今天天气怎么样？
> AI：抱歉，我无法获取实时天气信息。

有工具时：
> 你：北京今天天气怎么样？
> AI：让我查一下...
> （调用天气查询工具）
> AI：北京今天晴朗，25°C，适合外出！

**场景：读取文件**

没有工具时：
> 你：帮我看看 config.json 里写了什么
> AI：抱歉，我无法访问你的本地文件。

有工具时：
> 你：帮我看看 config.json 里写了什么
> AI：好的，让我读取一下...
> （调用文件读取工具）
> AI：config.json 里配置了：
> - 模型：GPT-4
> - 语言：中文
> - 调试模式：开启

---

## 13.2 工具的类型

### 13.2.1 按功能分类

OpenClaw 提供了丰富的内置工具：

| 类别 | 工具示例 | 用途 |
|------|---------|------|
| **文件操作** | 读取文件、写入文件、列出目录 | 管理本地文件 |
| **代码执行** | 执行 Python、执行 Shell 命令 | 运行代码 |
| **网络请求** | 网页搜索、获取网页内容 | 访问互联网 |
| **浏览器** | 打开网页、点击元素、输入文字 | 自动化浏览器 |
| **媒体处理** | 读取图片、转录语音 | 处理多媒体 |
| **系统操作** | 执行系统命令、查看系统信息 | 控制系统 |

### 13.2.2 按使用方式分类

**同步工具**：
- 立即执行，立即返回结果
- 比如：读取文件、查询天气
- 适合快速操作

**异步工具**：
- 执行时间较长，需要等待
- 比如：下载大文件、批量处理数据
- 适合耗时操作

### 13.2.3 工具 vs 技能

你可能还听说过"技能（Skills）"，两者有什么区别？

| 对比项 | 工具（Tools） | 技能（Skills） |
|--------|--------------|---------------|
| **粒度** | 单一功能 | 多个功能的组合 |
| **复杂度** | 简单、专注 | 复杂、完整 |
| **例子** | 读取文件、发送邮件 | Git 管理、Docker 操作 |
| **安装** | 内置或简单配置 | 需要独立安装 |

**类比**：
- **工具** = 单个工具（螺丝刀、锤子）
- **技能** = 工具箱（包含多种工具的完整套装）

---

## 13.3 工具的工作原理

### 13.3.1 AI 如何决定使用工具？

**决策流程**：

1. **用户提问**
   > 你：帮我查一下 OpenClaw 的 GitHub 仓库有多少 Star？

2. **AI 分析**
   - 理解意图：需要查询 GitHub 数据
   - 判断能力：我自己不知道实时数据
   - 选择工具：需要网络请求工具

3. **调用工具**
   - AI 生成工具调用请求
   - 系统执行工具
   - 获取结果

4. **生成回复**
   - AI 根据工具结果组织语言
   - 返回给用户

**实际过程**：

> 你：帮我查一下 OpenClaw 的 GitHub 仓库有多少 Star？
> 
> AI 思考：这需要访问 GitHub API，我应该使用网络请求工具。
> 
> AI 调用工具：
> - 工具：web_search
> - 参数：query="OpenClaw GitHub stars"
> 
> 工具返回：OpenClaw 仓库有 1,234 Star
> 
> AI 回复：OpenClaw 的 GitHub 仓库目前有 1,234 个 Star！

### 13.3.2 工具调用的参数

**参数是什么？**

参数就是告诉工具具体要做什么的详细信息。

**示例：天气查询工具**

需要的参数：
| 参数 | 说明 | 示例 |
|------|------|------|
| city | 城市名称 | "北京" |
| date | 日期 | "今天"、"明天" |

AI 会自动提取：
> 你：明天上海天气怎么样？
> 
> AI 提取参数：
> - city: "上海"
> - date: "明天"

**示例：文件读取工具**

需要的参数：
| 参数 | 说明 | 示例 |
|------|------|------|
| file_path | 文件路径 | "/Users/docs/readme.md" |
| limit | 读取行数 | 50（可选） |

AI 会自动理解：
> 你：看看 readme.md 的前 50 行
> 
> AI 提取参数：
> - file_path: "readme.md"
> - limit: 50

### 13.3.3 错误处理

**工具执行失败怎么办？**

**场景一：文件不存在**

> 你：读取不存在的文件.txt
> 
> 工具返回错误：文件不存在
> 
> AI 回复：抱歉，找不到 "不存在的文件.txt"，请确认文件路径是否正确。

**场景二：网络超时**

> 你：查询某个网站
> 
> 工具返回错误：连接超时
> 
> AI 回复：抱歉，无法访问该网站，可能是网络问题或网站不可用。

**场景三：权限不足**

> 你：删除系统文件
> 
> 工具返回错误：权限不足
> 
> AI 回复：抱歉，我没有权限执行这个操作。

---

## 13.4 常用工具介绍

### 13.4.1 文件操作工具

**读取文件（read_file）**

用途：读取本地文件内容

使用场景：
- 查看配置文件
- 阅读代码
- 查看日志

示例：
> 你：帮我看看 package.json 里有什么依赖
> AI：（调用 read_file 读取 package.json）
> AI：package.json 中的依赖包括：express、lodash、axios...

**写入文件（write_file）**

用途：创建或修改文件

使用场景：
- 创建新文件
- 修改配置
- 保存数据

示例：
> 你：创建一个 hello.txt，内容是 "Hello World"
> AI：（调用 write_file 创建文件）
> AI：已创建 hello.txt，内容为 "Hello World"

### 13.4.2 代码执行工具

**执行代码（execute_code）**

用途：运行代码并获取结果

使用场景：
- 计算复杂公式
- 数据处理
- 快速测试代码

示例：
> 你：计算 123 的平方根
> AI：（调用 execute_code 计算）
> AI：123 的平方根约等于 11.09

**执行命令（execute_command）**

用途：执行系统命令

使用场景：
- 查看系统信息
- 运行脚本
- 管理系统

示例：
> 你：查看当前目录下有哪些文件
> AI：（调用 execute_command 执行 ls）
> AI：当前目录下有：docs、src、package.json、README.md

### 13.4.3 网络工具

**网页搜索（web_search）**

用途：搜索互联网信息

使用场景：
- 查询最新资讯
- 查找技术文档
- 了解实时信息

示例：
> 你：搜索 OpenClaw 的最新版本
> AI：（调用 web_search）
> AI：OpenClaw 最新版本是 v2.5.0，发布于 2024年1月...

**获取网页（fetch_url）**

用途：获取指定网页的内容

使用场景：
- 读取文章
- 查看文档
- 获取特定页面信息

示例：
> 你：获取 https://example.com 的内容
> AI：（调用 fetch_url）
> AI：该网页的主要内容是...

### 13.4.4 浏览器工具

**打开网页（browser_open）**

用途：在浏览器中打开网页

使用场景：
- 自动化测试
- 网页截图
- 数据抓取

**点击元素（browser_click）**

用途：模拟点击网页元素

使用场景：
- 自动化操作
- 表单填写
- 导航页面

**输入文字（browser_type）**

用途：在输入框中输入文字

使用场景：
- 自动登录
- 搜索内容
- 填写表单

---

## 13.5 工具的安全使用

### 13.5.1 权限控制

**为什么需要权限控制？**

工具很强大，但也可能危险：
- 误删重要文件
- 执行恶意代码
- 泄露敏感信息

**安全措施**：

1. **文件访问限制**
   - 只能访问指定目录
   - 不能访问系统关键文件

2. **命令执行限制**
   - 禁止危险命令（rm -rf /）
   - 限制执行时间

3. **网络访问限制**
   - 限制可访问的域名
   - 防止访问恶意网站

### 13.5.2 用户确认

**敏感操作需要确认**：

对于危险操作，系统会要求用户确认：

> AI：我即将删除文件 "old-data.txt"，确认吗？
> 
> 你：确认
> AI：（执行删除）
> AI：文件已删除

### 13.5.3 最佳实践

**给用户的建议**：

1. **了解工具的能力**
   - 知道 AI 能做什么
   - 知道 AI 不能做什么

2. **谨慎授权**
   - 不要随意给予高权限
   - 定期检查权限设置

3. **备份重要数据**
   - 在执行删除操作前备份
   - 重要文件多份保存

---

## 13.6 本章小结

### 核心要点

1. **工具的作用**
   - 让 AI 能够做实事
   - 连接 AI 和外部世界
   - 把想法变成行动

2. **工具的类型**
   - 文件操作、代码执行、网络请求、浏览器控制
   - 同步工具、异步工具
   - 工具 vs 技能

3. **工作原理**
   - AI 分析需求 → 选择工具 → 执行 → 返回结果
   - 自动提取参数
   - 错误处理机制

4. **安全使用**
   - 权限控制
   - 敏感操作确认
   - 最佳实践

### 类比总结

| 概念 | 类比 | 作用 |
|------|------|------|
| AI 模型 | 大脑 | 思考、决策 |
| 工具 | 手 | 执行、操作 |
| 参数 | 指令细节 | 告诉手具体怎么做 |
| 结果 | 反馈 | 告诉大脑执行效果 |

### 下一步

在下一章，我们将学习 **记忆系统（RAG）**：
- 如何让 AI 记住长期信息
- 向量数据库的工作原理
- 检索增强生成（RAG）

---

## 参考资源

- OpenClaw 工具文档
- 工具开发指南
- 安全最佳实践
